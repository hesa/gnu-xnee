@chapter File types and format

The files used by Xnee are
@itemize @bullet
@item  Xnee Project File
@item  Xnee Session File
@end itemize
These files must follow the Xnee File Format.

@section Project file
@cindex  Project file
Xnee can be set either using command line options (when using xnee) or by
clicking the correct buttons etc in the GUI (using gnee). Instead of setting 
the same settings over and over again, you can use the Xnee Project File. 


@subsection  Create a project file
@cindex      Create a project file
You can create a project by yourself. This can be done using 
the @code{write-settings} option in cnee or the ``save settings to file'' 
when using gnee or you can use the Xnee GUI (gnee) to write one.
You can also write one by yourself in your favorite editor.  Just make sure you 
follow the Xnee format. For information and specification on this format read 
the Xnee format chapter.
@ 

The authors of Xnee suggests you start of with a generated project file. To get one 
such file, type the following
@code{cnee --mouse --keyboard --write-settings new_proj.xnp}. You will now 
have a file @code{new_proj.xnp} with some useful values, which you can edit as you wish.
@ 

To use this file to record, simply type
@code{cnee --record --project new_proj.xnp}


@section Xnee Session file
@cindex  Session file
The Xnee session files are the printouts from a recorded session following the Xnee File Format. For information and specification on this format read the Xnee File Format chapter.



@section Xnee file format
The Xnee Format is divided into different directives. 
The format is line based, meaning that

@itemize @bullet
@item  there is one directive per line
@item  one line contains one (and only one) directive
@end itemize
These directives are definied as follows. 

@section Xnee directives 
The following directives are used in Xnee:
@multitable  @columnfractions .0 .30 .70
@item 
@tab @b{Directives}
@tab @b{Description}

@item
@tab Comment 
@tab This is used to comment the various files

@item
@tab Project
@tab These contains information about the session- or project file

@item
@tab Settings
@tab Data used when recording and replaying

@item
@tab Replay data
@tab Recorded replayable data (used when replaying)

@item
@tab Script replay data 
@tab Scriptable primitives

@item
@tab Mark
@tab Lines inserted in the seesion file when a modifier+key was pressed

@item
@tab Execution 
@tab Lines that trigger the execution of an external program

@item
@tab  Project information
@tab  Project

@end multitable



@subsection Comment 
@cindex  Comment directives


@multitable  @columnfractions .0 .20 .50 .30
@item 
@tab @b{First token}
@tab @b{Interpretation}

@item
@tab  #
@tab  Ignored
@end multitable
As long as the first token is @code{#} it is intrepreted as a comment, just
as in bash.

@subsection Settings 
@cindex Settings
@multitable  @columnfractions .0 .25 .15 .60
@item 
@tab @b{Settings directive}
@tab @b{Argument}
@tab @b{Interpretation}

@item
@tab  data-to-record
@tab  integer
@tab  Limits the number of data to record to to the integer value

@item
@tab  events-to-record
@tab  integer
@tab  Limits the number of events to record to to the integer value

@item
@tab  time-to-record
@tab  integer
@tab  Limits the number of seconds to record to to the integer value

@item
@tab  display
@tab  string
@tab  Sets the display to record or replay to the string

@item
@tab  distribute
@tab  string 
@tab  Distribute all recorded or replayed replayable events to the display given by the string

@item
@tab  file
@tab  string
@tab  Read replay data from the file given by the string

@item
@tab  out-file
@tab  string
@tab  Print recorded data to the file given by the string

@item
@tab  plugin
@tab  string
@tab  Use the plugin given by the string

@item
@tab  first-last
@tab  boolean 
@tab  Print only first and last of successive MotionNotify events

@item
@tab  verbose
@tab  boolean
@tab  Use verbose debugging printout

@item
@tab  buffer-verbose
@tab  boolean
@tab  Use verbose buffer verbose printouts (not built by default)

@item
@tab  time
@tab  integer
@tab  Delay the start of the Xnee action 

@item
@tab  all-clients
@tab  boolean
@tab  Record all curret and future clients (default)

@item
@tab  future-clients
@tab  boolean
@tab  Record only future clients

@item
@tab  human-printout
@tab  boolean
@tab  Prints the recorded data in a (quite) more ser friendly format

@item
@tab  sync-mode
@tab  boolean
@tab  Sets recording mode

@item
@tab  speed-percent
@tab  integer
@tab  Sets the replaying speed percentage to the integer value

@item
@tab  stop-key
@tab  string,string
@tab  Sets the stop key combination to the strings

@item
@tab  pause-key
@tab  string,string
@tab  Sets the pause key combination to the strings

@item
@tab  resume-key
@tab  string,string
@tab  Sets the resume key combination to the strings

@item
@tab  mark-key
@tab  string,string
@tab  Sets the mark key combination to the strings

@item
@tab  exec-key
@tab  string,string
@tab  Sets the execute key combination to strings

@item
@tab  replay-resolution
@tab  string 
@tab  Sets the replay resolution to the string 

@item
@tab  resolution-adjustment
@tab  boolean
@tab  Use resolution adjustment, even if the recored resolution differs from the one to replay to

@item 
@tab  event-range
@tab  range
@tab  Sets the events to record

@item 
@tab  error-range
@tab  range
@tab  Sets the errors to record to range*

@item 
@tab  request-range
@tab  range
@tab  Sets the request to record to range*

@item 
@tab  reply-range
@tab  range
@tab  Sets the replies to record to range*

@item
@tab  extension-request-major-range
@tab  range
@tab  Sets the extension requests (major) to record to range*

@item
@tab  extension-request-minor-range
@tab  range
@tab  Sets the extension requests (minor) to record to range*

@item
@tab  extension-reply-major-range
@tab  range
@tab  Sets the extension replies (major) to record to range*

@item
@tab  extension-reply-minor-range
@tab  range
@tab  Sets the extension replies (minor) to record to range*

@item
@tab  force-replay
@tab  boolean
@tab  Continue to replay even if Xnee is out of sync

@item
@tab  max-threshold
@tab  integer 
@tab  Sets the maximum synchronisation threshold 

@item
@tab  min-threshold
@tab  integer 
@tab  Sets the minimum synchronisation threshold 

@item
@tab  total-threshold
@tab  integer 
@tab  Sets the total maximum synchronisation threshold 

@item
@tab  events-to-record
@tab  integer 
@tab  Sets the number of events to record

@item
@tab  data-to-record
@tab  integer 
@tab  Sets the number of data to record

@item
@tab  time-to-record
@tab  integer 
@tab  Sets the number of seconds to record

@item
@tab  store-mouse-position
@tab  
@tab  If set, Xnee records the initial mouse position and makes sure that replaying starts from there

@end multitable

Xnee Settings Arguments
@cindex Xnee Settings Arguments
@multitable  @columnfractions .0 .20 .50 .30
@item 
@tab @b{Settings argument}
@tab @b{Description}
@tab @b{Example}

@item
@tab  @code{integer}
@tab  is an integer value
@tab  1

@item
@tab  @code{string}
@tab  is a string
@tab  localhost

@item
@tab  @code{boolean}
@tab  is a boolean value given by true/1 or false/0 
@tab  true, false, 0, 1

@item
@tab  @code{subrange}
@tab  Subrange is gives a range of data by specifying a start and stop
      data. In the case of one data the stop data can be omitted.
@tab  2-5 or MapNotify

@item
@tab  @code{range}
@tab  Ranges are a comma separated list of subranges. 
@tab  2-3,MotionNotify-MapNotify,GravityNotify,PropertyNotify,30

@item
@tab  
@tab  
@tab  

@end multitable



@subsection Replay 
@cindex Replay directive
@multitable  @columnfractions .0 .40 .60
@item 
@tab @b{Replay directive}
@tab @b{Interpretation}

@item 
@tab 0,0
@tab not valid

@item 
@tab 0,1
@tab not valid

@item 
@tab 0,2,keycode,time
@tab KeyPress on key with keycode, used to replay

@item 
@tab 0,3,keycode,time
@tab KeyRelease on key with keycode, used to replay

@item 
@tab 0,4,button nr,time
@tab ButtonPress on button nr, used to replay

@item 
@tab 0,5,button nr,time
@tab ButtonRelease on button nr, used to replay

@item 
@tab 0,6,x,y,time
@tab MotionNotify on poistion (x,y), used to replay

@item 
@tab 0,7-XXX,time
@tab MotionNotify on poistion (x,y), used to replay

@item 
@tab 1,request number,time
@tab Recorded request, used during synchronisation 

@item 
@tab 2,reply number,time
@tab Recorded reply, used during synchronisation 

@item 
@tab 3,error number,time
@tab Recorded error, used during synchronisation 


@end multitable
time is the time on the server the data was to the recording Xnee client. This time is used to keep the speed intact during replay.

@subsection Script replay data 
@cindex   Script replay data 

@multitable  @columnfractions .0 .40 .60
@item 
@tab @b{Primitive}
@tab @b{Interpretation}

@item 
@tab fake-motion
@tab Fakes a mouse motion 

@item 
@tab fake-button-press
@tab Fakes a button press

@item 
@tab fake-button-release
@tab Fakes a button release

@item 
@tab fake-button
@tab Fakes a button press and release

@item 
@tab fake-key-press
@tab Fakes a key press

@item 
@tab fake-key-release
@tab Fakes a key release

@item 
@tab fake-key
@tab Fakes a key press and release

@end multitable

@multitable  @columnfractions .0 .20  .20 .60
@item 
@tab @b{Primitive variable}
@tab @b{Primitive values}
@tab @b{Interpretation}

@item 
@tab  x=value
@tab  integer
@tab  Sets the x position used in fake-motion to value

@item 
@tab  x=value
@tab  +integer
@tab  Set the relative motion (x direction) used in fake-motion to value

@item 
@tab  x=value
@tab  -integer
@tab  Set the relative motion (x direction) used in fake-motion to value

@item 
@tab  y=value
@tab  Sets the y position used in fake-motion to value

@item 
@tab  y=value
@tab  +integer
@tab  Set the relative motion (y direction) used in fake-motion to value

@item 
@tab  y=value
@tab  -integer
@tab  Set the relative motion (y direction) used in fake-motion to value

@item 
@tab  button=value
@tab  set the button to fake with fake-button-press, fake-button-release and fake-button to value

@item 
@tab  key=value
@tab  set the key to fake with fake-key-press, fake-key-release and fake-key to value

@end multitable


@subsection Mark 
@cindex  Mark directive
@multitable  @columnfractions .0 .20 .20 .60
@item 
@tab @b{First tokens}
@tab @b{Arguments}
@tab @b{Interpretation}

@item
@tab  Mark
@tab  time string
@tab  Ignored. This feature is intended to let the user do whatever he/she
      wants to. This will obviously lead to modifying the source code etc.
@end multitable


@subsection Exec 
@cindex  Exec directive
@multitable  @columnfractions .0 .20 .20 .60
@item 
@tab @b{First tokens}
@tab @b{Arguments}
@tab @b{Interpretation}

@item
@tab  Exec
@tab  command string
@tab  This is used during to replay to execute a given command. If no
      command string is found Xnee will try to
      read the command from the environment variable @code{XNEE_EXEC_COMMAND}
@end multitable


@subsection Project information 
@cindex  Project information directive
@multitable  @columnfractions .0 .45 .55
@item 
@tab @b{Project information directives}
@tab @b{Arguments}

@item
@tab  ProjectName
@tab  string s is the project name

@item
@tab  ProjectDescription
@tab  string s is the project description

@item
@tab  ProjectCreationDate
@tab  string s is the project creation date

@item
@tab  ProjectCreationProgram
@tab  string s is the name of the program that create the project file

@item
@tab  ProjectCreationProgVersion
@tab  string s is the version of the program that create the project file

@item
@tab  ProjectLastChangeDate
@tab  string s is the date of the last change of the project file

@item
@tab  ProjectLastChangeProgram
@tab  string s is the name of the program that last changed of the project file

@item
@tab  ProjectLastChangeVersion
@tab  string s is the version of the program that last changed of the project file

@item
@tab  ProjectCurrentChangeDate
@tab  string s is the date of the current change of the project file

@item
@tab  ProjectCurrentChangeProgram
@tab  string s is the name of the program that current changed of the project file

@item
@tab  ProjectCurrentChangeVersion
@tab  string s is the version of the program that current changed of the project file


@end multitable
